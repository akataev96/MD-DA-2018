---
title: "Lab3"
author: "Andrei Kataev"
date: '23 декабря 2018 г '
output: html_document
---

##Исходные данные

Файл forbes.htm содержит список богатейших американцев по версии журнала Форбс. На его примере потренируемся в разборе html страниц.

#Задание 1

Используйте команду readLines для загрузки файла в текстовый вектор html.
```{r}
forbes<-readLines("forbes.htm" )
```

Сколько строк в файле?
```{r}
length(forbes)
```

Сколько символов в файле?
```{r}
sum(nchar(forbes))
```

Откройте файл в текстовом редакторе. Найдите строки, содержащие данные о Билле Гейтсе и Ларри Эллисоне и запомните размер их дохода.
Билл Гейтс - 72B$, Ларри Эллисон - 41B$.

Напишите шаблон регулярного выражения и используйте функцию grep, чтобы извлечь размер дохода из данных в векторе html.
```{r}
emoluments<-grep("[$](\\d+,*\\d*) B", forbes)
emoluments
```

Удостоверьтесь, что полученный вектор номеров строк содержит содержит ровно 100 записей и ссылается на номера строк в котрых действительно есть информация о доходе, а не просто первый попавшийся текст.
```{r}
forbes[emoluments]

length(emoluments)
```

Напишите код, использовав регулярное выражение из п. 3, и функции regexp и regmatches, чтобы извлечь все данные о доходе.
```{r}
emoluments.positions<-regexpr("[$](\\d+,*\\d*) B", forbes)
emoluments.value<-regmatches(forbes,emoluments.positions)
emoluments.positions
emoluments.value
```

Проверьте следующее:
Должно быть ровно сто значений.
```{r}
length(emoluments.value)
```

Самый большой доход должен быть доход Билла Гейтса
```{r}
emoluments.value[1]
```

Такой доход должен быть в списке один раз.
```{r}
length(emoluments.value[emoluments.value=="$72 B"])
```

В всписке должна быть цифра, которую мы запомнили для Ларри Эллисона.
```{r}
emoluments.value[3]
```

Должно быть как минимум два значения, встречающихся несколько раз.
```{r}
length(unique(emoluments.value))
```
Неповторяющихся значений в ``emoluments.value`` всего 66 из 100.

#Задание 2

В данных доход представлен в формате "$42 B", что означает 42 *??* 10^9. Преобразуйте этот формат в числовой и сохраните в вектор worths.
```{r}
worths<-as.numeric(sub(",",".", regmatches(emoluments.value, regexpr('(\\d+,*\\d*)',emoluments.value))))*10^9 
worths
```

Удостоверьтесь в следующем:
worths является вектором и в нём сто занчений типа double.
```{r}
is.vector(worths)
typeof(worths)
```

Все элементы вектора worths больше 1 миллиарда.
```{r}
length(worths[worths>10^9])
```

Самое большое число это доход Билла Гейтса.
```{r}
worths[which(worths==max(worths))]
```

Используйте вектор worths , чтобы выяснить следующее:
Какова медиана ста этих записей?
```{r}
median(worths)
```

Средний доход?
```{r}
mean(worths)
```

Как много людей из этого списка имеют доход больше 5млрд., 10, 25?
```{r}
length(worths[worths>5*10^9])
length(worths[worths>10*10^9])
length(worths[worths>25*10^9])
```

Какой их общий доход?
```{r}
sum(worths)
```

Какую долю от общего дохода, составляет пятёрка самых богатых.
```{r}
sum(worths[1:5])/sum(worths)
```

Какую долю от общего дохода, составляют 20 самых богатых.
```{r}
sum(worths[1:20])/sum(worths)
```

В данных федерального резерва США найдите показатель дохода всех домохозяйств (Household net worth) в соответвующем году, какую долю общего дохода составляют 100 богатейших людей.
```{r}
household.2013 <- 78.536*10^9
household.2013/sum(worths)
```
